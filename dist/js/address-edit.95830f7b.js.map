{"version":3,"sources":["webpack:///./src/views/AddressEdit.vue?d801","webpack:///./src/components/SimpleHeader.vue","webpack:///./src/components/SimpleHeader.vue?aeba","webpack:///./src/components/SimpleHeader.vue?b187","webpack:///./src/service/address.js","webpack:///./node_modules/core-js/modules/es.object.entries.js","webpack:///./node_modules/core-js/internals/object-to-array.js","webpack:///./src/views/AddressEdit.vue","webpack:///./src/views/AddressEdit.vue?97bb","webpack:///./node_modules/core-js/modules/es.array.find-index.js"],"names":["class","isback","goBack","name","props","type","String","default","back","noback","Boolean","emits","setup","ctx","router","push","path","go","emit","render","__scopeId","addAddress","params","axios","post","EditAddress","put","DeleteAddress","id","delete","getDefaultAddress","get","getAddressList","pageNumber","pageSize","getAddressDetail","$","$entries","entries","target","stat","O","DESCRIPTORS","objectKeys","toIndexedObject","propertyIsEnumerable","f","createMethod","TO_ENTRIES","it","key","keys","length","i","result","call","module","exports","values","area-list","areaList","address-info","addressInfo","show-delete","show-set-default","show-search-result","search-result","searchResult","area-columns-placeholder","onSave","onDelete","components","sHeader","route","state","province_list","city_list","county_list","addressId","from","query","_province_list","_city_list","_county_list","getLev1","forEach","p","text","getLev2","c","getLev3","q","addressDetail","data","_areaCode","province","Object","regionName","provinceIndex","findIndex","item","substr","cityItem","filter","cityId","provinceName","cityName","userName","tel","userPhone","city","county","detailAddress","areaCode","isDefault","defaultFlag","content","setTimeout","$findIndex","addToUnscopables","arrayMethodUsesToLength","FIND_INDEX","SKIPS_HOLES","USES_TO_LENGTH","Array","proto","forced","callbackfn","this","arguments","undefined"],"mappings":"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","file":"js/address-edit.95830f7b.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./AddressEdit.vue?vue&type=style&index=0&id=870d1cda&lang=less\"","<template>\r\n  <header class=\"simple-header van-hairline--bottom\">\r\n    <i v-if=\"!isback\" class=\"nbicon nbfanhui\" @click=\"goBack\"></i>\r\n    <i v-else>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</i>\r\n    <div class=\"simple-header-name\">{{ name }}</div>\r\n    <i class=\"nbicon nbmore\"></i>\r\n  </header>\r\n  <div class=\"block\" />\r\n</template>\r\n\r\n<script>\r\nimport { ref } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nexport default {\r\n  props: {\r\n    name: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    back: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    noback: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  emits: ['callback'],\r\n  setup(props, ctx) {\r\n    const isback = ref(props.noback)\r\n    const router = useRouter()\r\n    const goBack = () => {\r\n      if (!props.back) {\r\n        router.go(-1)\r\n      } else {\r\n        router.push({ path: props.back })\r\n      }\r\n      ctx.emit('callback')\r\n    }\r\n    return {\r\n      goBack,\r\n      isback\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  @import '../common/style/mixin';\r\n  .simple-header {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    z-index: 10000;\r\n    .fj();\r\n    .wh(100%, 44px);\r\n    line-height: 44px;\r\n    padding: 0 10px;\r\n    .boxSizing();\r\n    color: #252525;\r\n    background: #fff;\r\n    .simple-header-name {\r\n      font-size: 14px;\r\n    }\r\n  }\r\n  .block {\r\n    height: 44px;\r\n  }\r\n</style>\r\n","import { render } from \"./SimpleHeader.vue?vue&type=template&id=97148694&scoped=true\"\nimport script from \"./SimpleHeader.vue?vue&type=script&lang=js\"\nexport * from \"./SimpleHeader.vue?vue&type=script&lang=js\"\n\nimport \"./SimpleHeader.vue?vue&type=style&index=0&id=97148694&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-97148694\"\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SimpleHeader.vue?vue&type=style&index=0&id=97148694&lang=less&scoped=true\"","import axios from '../utils/axios'\r\n\r\nexport function addAddress(params) {\r\n  return axios.post('/address', params);\r\n}\r\n\r\nexport function EditAddress(params) {\r\n  return axios.put('/address', params);\r\n}\r\n\r\nexport function DeleteAddress(id) {\r\n  return axios.delete(`/address/${id}`);\r\n}\r\n\r\nexport function getDefaultAddress() {\r\n  return axios.get('/address/default');\r\n}\r\n\r\nexport function getAddressList() {\r\n  return axios.get('/address', { pageNumber: 1, pageSize: 1000 })\r\n}\r\n\r\nexport function getAddressDetail(id) {\r\n  return axios.get(`/address/${id}`)\r\n}\r\n\r\n\r\n","var $ = require('../internals/export');\nvar $entries = require('../internals/object-to-array').entries;\n\n// `Object.entries` method\n// https://tc39.github.io/ecma262/#sec-object.entries\n$({ target: 'Object', stat: true }, {\n  entries: function entries(O) {\n    return $entries(O);\n  }\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar objectKeys = require('../internals/object-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar propertyIsEnumerable = require('../internals/object-property-is-enumerable').f;\n\n// `Object.{ entries, values }` methods implementation\nvar createMethod = function (TO_ENTRIES) {\n  return function (it) {\n    var O = toIndexedObject(it);\n    var keys = objectKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || propertyIsEnumerable.call(O, key)) {\n        result.push(TO_ENTRIES ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n\nmodule.exports = {\n  // `Object.entries` method\n  // https://tc39.github.io/ecma262/#sec-object.entries\n  entries: createMethod(true),\n  // `Object.values` method\n  // https://tc39.github.io/ecma262/#sec-object.values\n  values: createMethod(false)\n};\n","<template>\r\n  <div class=\"address-edit-box\">\r\n    <s-header :name=\"`${type == 'add' ? '新增地址' : '编辑地址'}`\"></s-header>\r\n    <van-address-edit\r\n      class=\"edit\"\r\n      :area-list=\"areaList\"\r\n      :address-info=\"addressInfo\"\r\n      :show-delete=\"type == 'edit'\"\r\n      show-set-default\r\n      show-search-result\r\n      :search-result=\"searchResult\"\r\n      :area-columns-placeholder=\"['请选择', '请选择', '请选择']\"\r\n      @save=\"onSave\"\r\n      @delete=\"onDelete\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, onMounted, toRefs } from 'vue'\r\nimport { Toast } from 'vant'\r\nimport sHeader from '@/components/SimpleHeader'\r\nimport { addAddress, EditAddress, DeleteAddress, getAddressDetail } from '@/service/address'\r\nimport { tdist } from '@/common/js/utils'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nexport default {\r\n  components: {\r\n    sHeader\r\n  },\r\n  setup() {\r\n    const route = useRoute()\r\n    const router = useRouter()\r\n    const state = reactive({\r\n      areaList: {\r\n        province_list: {},\r\n        city_list: {},\r\n        county_list: {}\r\n      },\r\n      searchResult: [],\r\n      type: 'add',\r\n      addressId: '',\r\n      addressInfo: {},\r\n      from: route.query.from\r\n    })\r\n\r\n    onMounted(async () => {\r\n      // 省市区列表构造\r\n      let _province_list = {}\r\n      let _city_list = {}\r\n      let _county_list = {}\r\n      tdist.getLev1().forEach(p => {\r\n        _province_list[p.id] = p.text\r\n        tdist.getLev2(p.id).forEach(c => {\r\n          _city_list[c.id] = c.text\r\n          tdist.getLev3(c.id).forEach(q => _county_list[q.id] = q.text)\r\n        })\r\n      })\r\n      state.areaList.province_list = _province_list\r\n      state.areaList.city_list = _city_list\r\n      state.areaList.county_list = _county_list\r\n\r\n      const { addressId, type, from } = route.query\r\n      state.addressId = addressId\r\n      state.type = type\r\n      state.from = from || ''\r\n      if (type == 'edit') {\r\n        const { data: addressDetail } = await getAddressDetail(addressId)\r\n        let _areaCode = ''\r\n        const province = tdist.getLev1()\r\n        Object.entries(state.areaList.county_list).forEach(([id, text]) => {\r\n          // 先找出当前对应的区\r\n          if (text == addressDetail.regionName) {\r\n            // 找到区对应的几个省份\r\n            const provinceIndex = province.findIndex(item => item.id.substr(0, 2) == id.substr(0, 2))\r\n            // 找到区对应的几个市区\r\n            // eslint-disable-next-line no-unused-vars\r\n            const cityItem = Object.entries(state.areaList.city_list).filter(([cityId, cityName]) => cityId.substr(0, 4) == id.substr(0, 4))[0]\r\n            // 对比找到的省份和接口返回的省份是否相等，因为有一些区会重名\r\n            if (province[provinceIndex].text == addressDetail.provinceName && cityItem[1] == addressDetail.cityName) {\r\n              _areaCode = id\r\n            }\r\n          }\r\n        })\r\n        state.addressInfo = {\r\n          id: addressDetail.addressId,\r\n          name: addressDetail.userName,\r\n          tel: addressDetail.userPhone,\r\n          province: addressDetail.provinceName,\r\n          city: addressDetail.cityName,\r\n          county: addressDetail.regionName,\r\n          addressDetail: addressDetail.detailAddress,\r\n          areaCode: _areaCode,\r\n          isDefault: !!addressDetail.defaultFlag\r\n        }\r\n      }\r\n    })\r\n\r\n    const onSave = async (content) => {\r\n      const params = {\r\n        userName: content.name,\r\n        userPhone: content.tel,\r\n        provinceName: content.province,\r\n        cityName: content.city,\r\n        regionName: content.county,\r\n        detailAddress: content.addressDetail,\r\n        defaultFlag: content.isDefault ? 1 : 0,\r\n      }\r\n      if (state.type == 'edit') {\r\n        params['addressId'] = state.addressId\r\n      }\r\n      await state.type == 'add' ? addAddress(params) : EditAddress(params)\r\n      Toast('保存成功')\r\n      setTimeout(() => {\r\n        router.back()\r\n      }, 1000)\r\n    }\r\n\r\n    const onDelete = async () => {\r\n      await DeleteAddress(state.addressId)\r\n      Toast('删除成功')\r\n      setTimeout(() => {\r\n        router.back()\r\n      }, 1000)\r\n    }\r\n\r\n    return {\r\n      ...toRefs(state),\r\n      onSave,\r\n      onDelete\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n  @import '../common/style/mixin';\r\n  .edit {\r\n    .van-field__body {\r\n      textarea {\r\n        height: 26px!important;\r\n      }\r\n    }\r\n  }\r\n  .address-edit-box {\r\n    .van-address-edit {\r\n      .van-button--danger {\r\n        background: @primary;\r\n        border-color: @primary;\r\n      }\r\n      .van-switch--on {\r\n        background: @primary;\r\n      }\r\n    }\r\n  }\r\n</style>\r\n","import { render } from \"./AddressEdit.vue?vue&type=template&id=870d1cda\"\nimport script from \"./AddressEdit.vue?vue&type=script&lang=js\"\nexport * from \"./AddressEdit.vue?vue&type=script&lang=js\"\n\nimport \"./AddressEdit.vue?vue&type=style&index=0&id=870d1cda&lang=less\"\nscript.render = render\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar $findIndex = require('../internals/array-iteration').findIndex;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND_INDEX = 'findIndex';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND_INDEX);\n\n// Shouldn't skip holes\nif (FIND_INDEX in []) Array(1)[FIND_INDEX](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.findIndex` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.findindex\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND_INDEX);\n"],"sourceRoot":""}